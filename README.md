# PaperCopilot: Automated Academic Paper Workflow

> **Purpose:** This project provides a fully automated, outline-driven, style-agnostic workflow for academic paper and essay creation, review, and export. It ensures compliance with professional academic standards, supports multiple citation styles, and streamlines collaboration between human and AI contributors.

> **Note:** The outline-driven, style-agnostic workflow described here is the single source of truth for all academic paper and essay automation in this repository. All contributors (human and AI) must follow the same workflow, compliance, and file handling rules, as described in this README and in `.github/copilot-instructions.md`. For architectural or strategic changes, consult `DECISIONS.md`.

## Core Workflow Principles
- All contributors must follow the outline-driven, style-agnostic workflow described in `DECISIONS.md`.
- Outlines in `outlines/` define only structure (section order/names/instructions). Style, citation, and formatting are enforced by the corresponding file in `guidelines/`.
- Never hardcode style rules in outlines or templates.
- Do not change `input_requirements.md` in any paper folder if it exists.
- Document all major changes in `LEARNINGS.md` and `DECISIONS.md`.

## Template Folder Deprecation (May 2025)
**All outlines in `outlines/` are now fully self-contained and do not require or reference any files from the `template/` folder.**

- All section instructions and content guidance are embedded directly in the outlines.
- The `template/` folder is no longer required for any workflow, automation, or content generation.
- You may safely delete the `template/` folder after confirming all custom content has been migrated to the outlines.

See each outline in `outlines/` for the latest, embedded section templates and instructions. For workflow and compliance details, see `WORKFLOW.md` and `README.md`. For style and formatting, see the appropriate file in `guidelines/`.

---

## Version 2: Outline-Driven, Style-Agnostic Workflow (2025+)
- All automation and Copilot workflows use outline selection logic instead of hardcoded chapter selection.
- Each paper or essay type is defined by a style-agnostic outline in outlines/ (e.g., researchpaper_general.md, essay_general.md). Outlines specify only the canonical structure (order and names of required/optional sections).
- All style, citation, and formatting rules are enforced by the corresponding file in guidelines/ (e.g., ieee.md, apa7.md). Outlines never include style rules.
- The automation and assembly scripts use the selected outline to determine which section files to assemble and in what order, ensuring flexibility and style-agnostic structure.
- Contributors (human and AI) must never hardcode style rules in outlines/ or templates/.
- All documentation, templates, and scripts have been updated to reflect this logic. See README.md and .github/copilot-instructions.md for details.
- To-do: Expand outlines/ to support additional popular academic structures (see DECISIONS.md for the list).

---

## Features
- Automated initialization of new academic papers and essays with all required files and section templates
- Support for multiple academic writing and citation styles
- Workflow automation for literature review, chapter/section drafting, peer review, and export
- Centralized reference management and style compliance
- Checklist-driven quality control and final validation
- Azure best practices integration for technical content
- Single-file workflow: all content is generated and exported from a single, paginated `paper.md` file per project
- Style-specific Pandoc templates for PDF/Word export (see `templates/`)
- LaTeX output generation (`paper.latex`) to preserve complex formulas and mathematical content
- No table of contents is generated by default; pagination is handled via explicit `\pagebreak` tags in markdown, converted to `\newpage` in LaTeX

---

## Supported Writing Styles

| Style      | Guideline File                  | Typical Use Cases                                      |
|------------|---------------------------------|--------------------------------------------------------|
| ABNT       | guidelines/abnt.md              | Academic work in Brazil                                |
| APA 7      | guidelines/apa7.md              | Social sciences, health sciences                       |
| Chicago    | guidelines/chicago.md           | Humanities, some social sciences                       |
| Harvard    | guidelines/harvard.md           | Social sciences, business, STEM                        |
| IEEE       | guidelines/ieee.md              | Engineering, computer science, technical fields        |
| MLA        | guidelines/mla.md               | Language, literature, humanities                       |
| Turabian   | guidelines/turabian.md          | Student papers in the US (based on Chicago style)      |
| Vancouver  | guidelines/vancouver.md         | Medical, scientific research                           |

For each style, see the corresponding guideline file for authoritative rules on structure, citations, references, and formatting.

---

| Outline File                          | Use Case / Structure Type                        |
|---------------------------------------|--------------------------------------------------|
| researchpaper_imrad.md                | Empirical research (IMRaD: Introduction, Methods, Results, Discussion) |
| researchpaper_literature_review.md    | Standalone literature reviews                    |
| researchpaper_humanities.md           | Humanities research papers (argument-driven, thematic) |
| researchpaper_general.md              | Generic research papers (flexible structure)      |
| researchpaper_case_study.md           | Case study research papers                       |
| researchpaper_dissertation.md         | Dissertations and theses (comprehensive, multi-chapter) |
| researchpaper_project.md              | Project/capstone reports                         |
| researchpaper_short_communication.md  | Short communications or brief reports             |
| researchpaper_systematic_review.md    | Systematic literature reviews                    |
| essay_analytical.md                   | Analytical essays                                |
| essay_argumentative.md                | Argumentative essays                             |
| essay_general.md                      | General essays (flexible, non-research)          |
| essay_reflective.md                   | Reflective essays                                |

For each outline, see the file in `outlines/` for the canonical structure, section instructions, and use case guidance.

---

## Outline Selection Logic

Instead of hardcoding chapter or section selection based on style, the workflow now uses an **outline selection logic**:

- The system reads `input_requirements.md` in the target folder to determine the paper or essay type (e.g., research paper, essay).
- It then selects the appropriate outline from the `outlines/` folder (e.g., `researchpaper_general.md`, `essay_general.md`).
- The outline provides the canonical structure: the order and names of required and optional sections, but **never any style, citation, or formatting rules**.
- All style enforcement (section naming, formatting, citation, etc.) is handled by the corresponding file in `guidelines/` (e.g., `ieee.md`, `apa7.md`).
- The automation and assembly scripts use the selected outline to determine which section files to assemble and in what order, ensuring flexibility and style-agnostic structure.

**Best Practices:**
- When adding new outlines, keep them style-agnostic and focused on structure only.
- When updating or adding new guidelines, include all style-specific rules and requirements.
- Document all changes and decisions in `LEARNINGS.md` and `DECISIONS.md`.

---

## Key User Commands and Automation Triggers

This repository supports the following user commands for automated academic paper workflows:

- **initiate [folder] with [requirements and customization]**: Initialize a new paper or essay folder with all required files, references, and checklist, using the provided requirements. The system will:
  - Read or create `input_requirements.md` in the target folder.
  - Select the appropriate outline from `outlines/` based on the requirements.
  - Create all required sections in a single file (`paper.md`) using the structure and instructions embedded in the selected outline. No content is copied from `template/`.
  - Never overwrite an existing `input_requirements.md`.

- **create content**: Generate content for all required sections in the selected folder, following the structure and instructions in the selected outline and consulting `input_requirements.md` for requirements and style.

- **review content**: Review generated content for academic quality, guideline compliance, and completeness. Optionally, use subcommands:
  - **review section [section name]**: Review a specific section for clarity, style, and completeness.
  - **review references**: Check that all in-text citations have corresponding, correctly formatted entries in `references.md`.
  - **review checklist**: Display or update the completion checklist for the paper folder, ensuring all workflow and quality steps are completed before submission or publication.

- **dive [section name]**: Provide a detailed breakdown, critique, or improvement suggestions for a specific section (e.g., "dive introduction").

- **save to word**: Assemble all sections in canonical order (as specified by the selected outline) and export the paper as a `.docx` file, ensuring all formatting and style requirements are met.

- **checklist**: Display or update the completion checklist for the paper folder, ensuring all workflow and quality steps are completed before submission or publication.

- **show outline**: Display the canonical structure and section instructions from the selected outline for the current paper or essay.

- **show requirements**: Display the current `input_requirements.md` for the selected folder.

These commands are recognized by Copilot and automation tools. For each, the workflow will:
- Consult `input_requirements.md` for requirements and style
- Use the selected outline for structure and section instructions
- Ensure all content is professional, fact-checked, and style-compliant
- Consolidate all references in `references.md`
- Remove instructional or outline text before final output

See the main instructions above for full workflow and compliance details.

---

## Key User Instructions

- **Specify the required writing style in `input_requirements.md` for each paper or essay.**
- Follow the workflow:
  1. Complete or review `input_requirements.md` in the folder, including the writing style.
  2. Draft each section using the structure and instructions embedded in the selected outline from `outlines/`.
  3. Add all cited sources to `references.md` (or Works Cited/Bibliography as required by the style).
  4. Peer review each section and complete `CHECKLIST.md` before final assembly.
  5. Assemble and export the document as a `.docx` or PDF file using the provided script.
  6. Double-check all requirements, formatting, and references before submission.

- **Automation & Copilot/AI Rules:**
  - All detailed automation, file handling, and Copilot/AI compliance instructions are maintained in `.github/copilot-instructions.md`. Refer to that file for operational rules and automation requirements.
  - Never change or delete the `input_requirements.md` file in any folder if it already exists. This preserves user instructions and requirements for the document.
  - If user instructions are missing, ambiguous, or contradictory, always ask clarifying questions before proceeding. Do not make assumptions—seek explicit guidance from the user to ensure correct and expected behavior.
  - Always follow the selected style's guideline file (see above) and project guidelines as described in `guidelines/GUIDELINES.md`.
  - Reference `DECISIONS.md` before making architectural or strategic changes.
  - Document all significant implementation learnings, optimizations, and failures in `LEARNINGS.md`.

---

## For Automation and AI Contributors

- All automation, Copilot, and AI contributors must follow the same workflow, compliance, and file handling rules as human contributors.
- The authoritative automation and Copilot/AI instructions are maintained in `.github/copilot-instructions.md`.
- Automation must:
  - Use outlines/ for structure only (never for style enforcement).
  - Use guidelines/ for all style, citation, and formatting rules.
  - Never overwrite or delete `input_requirements.md` if it exists in a folder.
  - Always ask for clarification if requirements are missing or ambiguous.
- All contributors must document significant changes, learnings, and decisions in `LEARNINGS.md` and `DECISIONS.md`.

> For full automation and Copilot/AI compliance details, see `.github/copilot-instructions.md`.

---

## Technical Implementation Details
- Documentation files (`README.md`, `guidelines/GUIDELINES.md`, `.github/copilot-instructions.md`, `DECISIONS.md`, `LEARNINGS.md`, `CHECKLIST.md`) are up to date and cross-referenced.
- The conversion script (`convert_to_word.py`) is used for converting documents to Word and LaTeX formats, with additional functionality to convert LaTeX to Word.
- The repository includes a `.gitignore`, `LICENSE`, `CONTRIBUTING.md`, and `CODE_OF_CONDUCT.md` for best practices and collaboration.
- **Version 2 Conversion Features:**
  - The conversion scripts:
    - Use outline-driven, style-agnostic logic: structure is determined by the selected outline in `outlines/`, and all style/citation/formatting rules are enforced by the corresponding file in `guidelines/`.
    - Always use the latest content from the single `paper.md` file for export; never use cached or outdated content.
    - Strictly enforce the presence of all required sections before conversion; halt and issue a clear error if any are missing.
    - Generate multiple output formats (Markdown→.docx, Markdown→.latex, and LaTeX→.docx) for comparison.
    - Support advanced markdown features (fenced code blocks, tables, raw HTML, footnotes, definition lists, smart punctuation, etc.) for high-fidelity Word and PDF output.
    - Use style-specific Pandoc templates for PDF/Word export (see `templates/`).
    - Remove all instructional, outline, or placeholder text from the final output before submission or publication.
    - Document and maintain Pandoc command-line arguments and test cases for conversion reliability.


## Page Breaks in Word

- Page breaks in the Markdown source (e.g., `\pagebreak` or `\newpage`) are now converted to DOCX-compatible page breaks using Pandoc's raw XML (`<w:br w:type="page"/>`). This ensures that each major section starts on a new page in the generated Word document.
- For PDF output, use Word's export feature to preserve these page breaks.

## Multiple Document Format Conversions

- The system now generates three separate output files for each paper:
  1. A Word document (`.docx`) generated from the Markdown source, with filename based on the short title.
  2. A LaTeX document (`paper.latex`) preserving complex mathematical formulas.
  3. A second Word document (with suffix `_latex.docx`) generated from the LaTeX source.
- This allows users to compare the different renderings and choose the one that best preserves formatting.
- To generate these files, simply run the conversion script as usual: `python convert_to_word.py <paper_folder>`
- Compare the two `.docx` files to identify any differences in formatting, especially for complex mathematical formulas.

---

*For full workflow, compliance, and customization details, consult the Copilot instructions and guideline files in the `guidelines/` folder.*
